<source>
  @type forward
  @id input_forward
  port 24224
  bind 0.0.0.0
</source>

<source>
  @type http
  @id input_http_test
  port 9880
  bind 0.0.0.0
</source>

<match test.**>
  @type loki
  @id output_loki_test
  url "http://loki:3100"
  
  <label>
    user_from_http user
    source "http"
  </label>
  
  line_format json
  
  # Теперь можно и удалить ключ, чтобы он не дублировался в логе
  remove_keys user
</match>

<match source.docker.**>
  @type loki
  @id output_loki_docker
  url "http://loki:3100"
  <label>
    container ${record["container_name"]}
  </label>
  line_format json
  remove_keys container_name, source
</match>